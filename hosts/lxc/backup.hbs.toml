hostname = "backup"
description = "various backup-related services"
start_on_boot = false

[stacks]
traefik = {}
dozzle = {}
backrest = {}
cronicle = {}
dagu = {}

[cpu]
cores = 4

[memory]
dedicated = 8192
swap = 4096

[disk]
size = 8

[[mount_points]]
volume = "{{{@pve.lxc.app_data_dir}}}/backup"
mount_point = "/docker"

# [[mount_points]]
# volume = "/void/backups"
# mount_point = "/mnt/backup-data/backups"

# [[mount_points]]
# volume = "/void/documents"
# mount_point = "/mnt/backup-data/documents"

# [[mount_points]]
# volume = "/void/drive"
# mount_point = "/mnt/backup-data/drive"

# [[mount_points]]
# volume = "/void/photos"
# mount_point = "/mnt/backup-data/photos"

# [[mount_points]]
# volume = "/void/restic/repos"
# mount_point = "/mnt/repos"

[[provisioners]]
type = "ansible"
playbook = "provisioners/ansible/lxc-init.yaml"
replayable = false

[[provisioners]]
type = "ansible"
playbook = "provisioners/ansible/create-ssh-key.yaml"
replayable = false

[provisioners.variables]
public_key = "{{{@pve.ssh.public_key}}}"
private_key = """{{{@pve.ssh.private_key}}}"""

[[provisioners]]
type = "script"
script = "provisioners/scripts/install-docker.sh"
