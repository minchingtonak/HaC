services:
  app:
    image: ghcr.io/itskovacs/trip:1.39.0@sha256:c86c5e7e565b824c22cff03d8ff0a6c86e8e84c2045387d26814c3e0477061a9
    # ports:
    #   - 127.0.0.1:8080:8000
    volumes:
      - /docker/trip:/app/storage
    command: ["fastapi", "run", "/app/trip/main.py", "--host", "0.0.0.0"]
    restart: unless-stopped
    labels:
      - traefik.enable=true
      - traefik.http.routers.trip.rule=Host(`{{{domainForApp "trip"}}}`)
      - traefik.http.routers.trip.entrypoints=https
      - traefik.http.routers.trip.tls=true
      - traefik.http.routers.trip.tls.certresolver=porkbun
      - traefik.http.routers.trip.service=trip
      - traefik.http.services.trip.loadbalancer.server.port=8000
    networks:
      - traefik

networks:
  traefik:
    external: true
