services:
  ac:
    image: copyparty/ac:1.19.23@sha256:9ecd09e08cd2baffbf05852b7772ba8b4fe8b43a0859c5bff1fa88e5d2ed66e2
    container_name: copyparty
    restart: unless-stopped
    user: "0:0"
    # ports:
    #   - '3939:3939'
    volumes:
      - /docker/copyparty:/cfg
      - ./copyparty.conf:/cfg/copyparty.conf
      - /mnt:/mnt
    labels:
      - traefik.enable=true
      - traefik.http.routers.copyparty.rule=Host(`{{{domainForApp "copyparty"}}}`)
      - traefik.http.routers.copyparty.entrypoints=https
      - traefik.http.routers.copyparty.tls=true
      - traefik.http.routers.copyparty.tls.certresolver=porkbun
      - traefik.http.routers.copyparty.service=copyparty
      - traefik.http.services.copyparty.loadbalancer.server.port=3939
      - traefik.http.routers.copyparty.middlewares=oidc-auth@file
    networks:
      - traefik

networks:
  traefik:
    external: true
