services:
  tailscale:
    image: tailscale/tailscale:v1.92.5@sha256:4a0aaacee6f28e724c1f80c986e5776c9c979d8f7e19274c2cae2d495cc8d625
    container_name: tailscale
    hostname: tailscale
    user: "0:10000"
    environment:
      - TS_AUTHKEY={{{SECRET_TAILSCALE_AUTHKEY}}}
      - TS_EXTRA_ARGS=--ssh --advertise-routes={{{TAILSCALE_SUBNET_ROUTES}}}
      - TS_STATE_DIR=/var/lib/tailscale
      - TS_USERSPACE=true
    volumes:
      - /docker/tailscale:/var/lib/tailscale # tailscale folder must be owned by lxc-root, permission errors otherwise
    cap_add:
      - net_admin
    network_mode: host
    restart: unless-stopped
