services:
  memos:
    image: neosmemo/memos:0.25.1@sha256:f1faf27fb60aff4df13fc2c6017baa7b6f8ea684dc9a9bff6f212a01d2efe108
    container_name: memos
    # ports:
    #   - "5230:5230"
    volumes:
      - /docker/memos:/var/opt/memos
    environment:
      - MEMOS_MODE=prod
      - MEMOS_PORT=5230
    restart: unless-stopped
    labels:
      - traefik.enable=true
      - traefik.http.routers.memos.rule=Host(`{{{domainForApp "memos"}}}`)
      - traefik.http.routers.memos.entrypoints=https
      - traefik.http.routers.memos.tls=true
      - traefik.http.routers.memos.tls.certresolver=porkbun
      - traefik.http.routers.memos.service=memos
      - traefik.http.services.memos.loadbalancer.server.port=5230
    networks:
      - traefik

networks:
  traefik:
    external: true
